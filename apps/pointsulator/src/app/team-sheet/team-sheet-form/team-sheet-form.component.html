<form [formGroup]="form" class="control-container">
  <mat-form-field>
    <mat-label>Valid From Week</mat-label>
    <select matNativeControl formControlName="week">
      <option *ngFor="let week of weeks" [ngValue]="week.num">
        Week #{{ week.num }}, commencing Friday
        {{ week.date | date: 'dd-MM-yyyy' }}
      </option>
    </select>
  </mat-form-field>

  <h3>Assets</h3>

  <div class="pt-errors" *ngIf="assetsArray.invalid">
    <p>Your selected team is not valid:</p>
    <ul>
      <li *ngIf="assetsArray.errors['keeper']">
        You must play exactly one non-subtitute keeper.
      </li>
      <li *ngIf="assetsArray.errors['defence']">
        You must play exactly one non-subtitute defence.
      </li>
      <li *ngIf="assetsArray.errors['formation']">
        You must play a legal formation: Either 4-5-1, 4-4-2, or 4-3-3.
      </li>
      <li *ngIf="assetsArray.errors['attack']"></li>
    </ul>
  </div>

  <table
    mat-table
    [dataSource]="assetsArray.controls"
    matSort
    (matSortChange)="onSort($event)"
    #dataTable
    class="pick-assets-table"
    formArrayName="assets"
  >
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
      <td mat-cell *matCellDef="let ctrl">{{ ctrl.value.asset.name }}</td>
    </ng-container>

    <ng-container matColumnDef="type">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Type</th>
      <td mat-cell *matCellDef="let ctrl">{{ ctrl.value.asset.type }}</td>
    </ng-container>

    <ng-container matColumnDef="team">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Team</th>
      <td mat-cell *matCellDef="let ctrl">
        {{ ctrl.value.asset.team }}
      </td>
    </ng-container>

    <ng-container matColumnDef="playing">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Playing</th>
      <td mat-cell *matCellDef="let asset; let i = index">
        <ng-container [formGroupName]="i">
          <mat-checkbox formControlName="playing"></mat-checkbox>
        </ng-container>
      </td>
    </ng-container>

    <ng-container matColumnDef="substitute">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Substitute</th>
      <td mat-cell *matCellDef="let asset; let i = index">
        <ng-container [formGroupName]="i">
          <mat-checkbox formControlName="substitute"></mat-checkbox>
        </ng-container>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
</form>
